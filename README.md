# Manifold learning for olfactory habituation to strongly fluctuating backgrounds

Numerical simulations of olfactory habituation models for the manuscript

> François X. P. Bourassa, Paul François, Gautam Reddy, Massimo Vergassola. "Manifold learning for olfactory habituation to strongly fluctuating backgrounds", [submitted], 2025. 

## Outline of the code

**Jupyter notebooks and scripts in the main folder**: simulations generating main figure results. 

- `turbulent_habituation_recognition.ipynb`: notebook with a sample run and performance characterization of the different habituation models on a background with turbulent statistics, as in figure 4. 
- `non-gaussian_habituation_recognition.ipynb`: notebook with a sample run on the background with weakly non-Gaussian statistics of figure 3. 
- `manifold_learning_filtering_tradeoffs.py`: plots of the analytical results on predictive filtering vs manifold learning tradeoffs (figures 1 and S1). 
- `run_performance_recognition.py`, `run_performance_dimensionality.py`: main scripts to launch the numerical experiments of figures 2 and 5, respectively, comparing the performance of various habituation models for new odor recognition. 
- `analyze_comparison_results.py`, `analyze_dimensionality_results.py`: scripts to analyze the results of these simulation results and generate the summary statistics shown in the figures.
- 

**Modules in `modelfcts`**: 
- `average_sub`, `biopca`, `ideal`, `ibcm`: implementation of the different habituation models and functions to integrate them numerically. 
- `tagging`: odor tag (Kenyon cell layer) computation.
- `ibcm_analytics`, `pca_analytics`: analytical results for the IBCM and BioPCA networks. 
- `backgrounds`, `distribs`: implementation of different stochastic background processes. 
- `checktools`: functions to test different parts of the models and code. 

**Modules in `simulfcts`**: functions used by the main scripts to run numerical simulations, using parallel processing, saving results to disk, etc. 
- `analysis`: functions used by the main `analyze...` scripts, to process simulation results. 
- `habituation_recognition`: functions to set up and launch parallel simulations of the various habituation models. 
- `habituation_recognition_lambda`: simulation functions to re-run the same simulation for various $\Lambda$ scales. 
- `idealize_recognition`: functions to compute ideal/optimal habituation model outputs, especially those that would have occured in existing (saved) simulations. 
- `plotting`: auxiliary plotting functions.  

**Code in the `secondary_scripts` folder**: main simulation code for supplementary results. 
- `run_performance_lambda.py`, `run_performance_noise.py`, `run_performance_w_norm_choice.py`: scripts to launch the simulations and new odor recognition tests of figures S11 (as a function of $\Lambda$), S8 (robustness against OSN noise), and S9 (W norm choice), respectively. 
- `analyze_lambda_results.py`, `analyze_noise_results.py`, `analyze_w_norm_results.py`: scripts to analyze these simulation results and generate the summary statistics shown in the figures. 
- `autocorrelation_turbulent.py`: to compute the autocorrelation function of the turbulent odor concentration process, shown in figure S1C. 
- `check_gaussian_noise_robustness.ipynb`: example simulation of the different habituation models in the presence of OSN noise (figure S8). 
- `importance_thirdmoment_ibcm.ipynb`: example simulation of the IBCM model on Gaussian versus weakly non-Gaussian backgrounds (figure S5). 
- `lognormal_habituation_recognition.ipynb`: example simulation and performance characterization of the different habituation models on a background with log-normal concentration statistics, for figure S6. 
- `toymodel_habituation_recognition.ipynb`: detailed analysis of habituation simulations on a toy two-odor background model, described in the supplementary materials and figures S4 and S7; in particular, analysis of ther IBCM model convergence time. 
- `turbulent_habituation_test_w_norms.ipynb`: notebook to run example habituation simulations with alternate $p, q$-norms in the $W$ update rule, as in figure S9. 

**Code in the `tests` folder**: scripts to test different parts of the numerical implementation of habituation models and background processes. 


**Code in the `final_plotting` folder**: code to produce the final main figures from the simulation results generated by main and secondary scripts. 


